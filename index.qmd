---
format:
   revealjs:
     slide-number: true
     incremental: true
     footer: "&copy; Eli Lilly and Company"
     view-distance: 100
     mobile-view-distance: 100
---

<center>
<br>
<h3>Friendly solutions to scary problems</h3>
<img src="./images/targets.png" height="400px">
<br>
<h4>Will Landau</h4>
</center>

## Background

<br>

* Training
    * Bayesian methods
    * Iowa State University, 2011-2016
* Career
    * Tools for statisticians (such as [`targets`](https://docs.ropensci.org/targets))
    * Eli Lilly and Company, 2016-present

## <span style="font-size:60%">Scary problems doing stats have non-stats solutions.</span>

![](./images/github.png)

## <span style="font-size:60%">Scary problems doing stats have non-stats solutions.</span>

![](./images/renv.png)

## <span style="font-size:60%">Scary problems doing stats have non-stats solutions.</span>

![](./images/quarto.png)

## <span style="font-size:60%">Scary problems doing stats have non-stats solutions.</span>

![](./images/targets-problem-solution.png)

## Example: Bayesian model validation {data-background-color=skyblue}

## Bayesian MMRM

![](./images/fev.png)

::: {style="font-size: 75%"}

* MMRM = mixed model for repeated measures.
* Longitudinal data with continuous outcomes.
* Bayesian version used in neuroscience and pulmonology.

:::

## Implementation

![](./images/brms.mmrm.png)

## Computational demands of Stan

![](./images/hmc.png)

::: {style="font-size: 75%"}

* Stan uses Hamiltonian Monte Carlo (HMC) to draw from the posterior distribution.
* Based on a physics simulation of a marble rolling around in a smooth bowl.
:::

## Computational demands of Stan

![](./images/hmc.png)

::: {style="font-size: 75%"}

* Bowl is moderately high-dimensional for MMRMs.
* Could take several minutes or hours to fit a single model!
:::

## Validate {brms.mmrm} with SBC {.smaller}

::: {.nonincremental}

* Simulation-based calibration (SBC) checking:

:::

<br>

$$
\begin{aligned}
\theta^{\text{sim}} &\sim p(\theta) \qquad &&\text{Draw parameters from the prior.} \\
y^{\text{sim}} &\sim p(y | \theta^{\text{sim}}) \qquad &&\text{Draw data given parameters.} \\
\theta^{(1)}, \ldots, \theta^{(M)} &\sim p(\theta | y^{\text{sim}})  \qquad &&\text{Draw HMC samples from the posterior} \\
r &= \sum_{m = 1}^M I \left [ \theta^{(m)} < \theta^{\text{sim}} \right ] && \text{Count number of HMC samples} < \theta^{\text{sim}}
\end{aligned}
$$

<br>

* Repeat for thousands of independent draws of $\theta^{\text{sim}}$!
* Check that the rank statistics $r$ are uniformly distributed.

## Recap



## Thanks!

<center>
<img src="./images/link.svg" width=400> <br>
<https://wlandau.github.io/LatinR2024>
</center>
